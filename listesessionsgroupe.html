<!doctype html>

<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Required meta tags -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Liste des sessions</title>
  <link rel="stylesheet" href="bootstrap-sncf.metier.v4.3.1-r5/bootstrap-sncf.min.css">
  <link rel="stylesheet alternate" href="bootstrap-sncf.metier.v4.3.1-r5/bootstrap-sncf.darkmode.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" type="text/css" href="jquery.dataTables.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/searchpanes/1.2.1/css/searchPanes.dataTables.min.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.3.1/css/select.dataTables.min.css"> 

</head>

<body>
    <div id="includedContentAC8"></div>
    
    <div class="container-fluid">
        <h1 class="text-center mb-5"> Liste des sessions du groupe OPSEG-20-6 </h1>
        <div class="row">

            <div class="col-md-12 mt-5">
                <div class="table-wrapper">
                    <div class="table-scroller last-cell-fixed dragscroll">
                      <table class="table display mb-5" id="sessionscofo">
                        <thead class="thead bg-secondary">
                          <tr>
                            <th scope="col">Code RAF</th>
                            <th scope="col">Libellé de l'action</th>
                            <th scope="col">Code Session</th>
                            <th scope="col">Lieu</th>
                            <th scope="col">Date de début</th>
                            <th scope="col">Date de fin</th>
                            <th scope="col"> Division métier</th>
                            <th scope="col"> État</th>
                          </tr>
                        </thead>
                        <tbody class="tbody">
                          <tr>
                            <td><div class="cell-inner text"> VS121100</div></td>
                            <td><div class="cell-inner"> Maintenance des installations 'Sol' TVM 300</div></td>
                            <td><div class="cell-inner"> NVS0000078</div></td>
                            <td><div class="cell-inner"> Bègles</div></td>
                            <td><div class="cell-inner"> 01/02/2021</div></td>
                            <td><div class="cell-inner"> 05/02/2021</div></td>
                            <td><div class="cell-inner"> Signalisation</div></td>
                            <td class="bg-success"><div class="cell-inner"> Passée</div></td>
                          </tr>
                          <tr>
                            <td><div class="cell-inner text"> VS121200</div></td>
                            <td><div class="cell-inner"> Maintenance des installation 'Sol' TVM 300 module A'</div></td>
                            <td><div class="cell-inner"> NVS0000073</div></td>
                            <td><div class="cell-inner"> Bègles</div></td>
                            <td><div class="cell-inner"> 14/02/2021</div></td>
                            <td><div class="cell-inner"> 19/02/2021</div></td>
                            <td><div class="cell-inner"> Signalisation</div></td>
                            <td class="bg-success"><div class="cell-inner"> Passée</div></td>
                          </tr>
                          <tr>
                            <td><div class="cell-inner text"> VS122100</div></td>
                            <td><div class="cell-inner"> Maintenance des installation 'Sol' TVM 430 module A</div></td>
                            <td><div class="cell-inner"> NVS0000074</div></td>
                            <td><div class="cell-inner"> Bègles</div></td>
                            <td><div class="cell-inner"> 01/03/2021</div></td>
                            <td><div class="cell-inner"> 05/03/2021</div></td>
                            <td><div class="cell-inner"> Signalisation</div></td>
                            <td class="bg-success"><div class="cell-inner"> Passée</div></td>
                          </tr>
                          <tr>
                            <td><div class="cell-inner text"> VS122200</div></td>
                            <td><div class="cell-inner"> Maintenance des installation 'Sol' TVM 430 module A'</div></td>
                            <td><div class="cell-inner"> NVS0000085</div></td>
                            <td><div class="cell-inner"> Nanterre</div></td>
                            <td><div class="cell-inner"> 15/03/2021</div></td>
                            <td><div class="cell-inner"> 19/03/2021</div></td>
                            <td><div class="cell-inner"> Signalisation</div></td>
                            <td class="bg-warning"><div class="cell-inner"> À venir</div></td>
                          </tr>
                          <tr>
                            <td><div class="cell-inner text"> VS123300</div></td>
                            <td><div class="cell-inner"> Maintenance des équipements 'SEI' module A</div></td>
                            <td><div class="cell-inner"> NVS0000082</div></td>
                            <td><div class="cell-inner"> Nanterre</div></td>
                            <td><div class="cell-inner"> 29/03/2021</div></td>
                            <td><div class="cell-inner"> 02/04/2021</div></td>
                            <td><div class="cell-inner"> Signalisation</div></td>
                            <td class="bg-warning"><div class="cell-inner"> À venir</div></td>
                          </tr>
                          <tr>
                            <td><div class="cell-inner text"> VS123400</div></td>
                            <td><div class="cell-inner"> Maintenance des équipements 'SEI' module A'</div></td>
                            <td><div class="cell-inner"> NVS0000090</div></td>
                            <td><div class="cell-inner"> Nanterre</div></td>
                            <td><div class="cell-inner"> 12/04/2021</div></td>
                            <td><div class="cell-inner"> 16/04/2021</div></td>
                            <td><div class="cell-inner"> Signalisation</div></td>
                            <td class="bg-warning"><div class="cell-inner"> À venir</div></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
            </div>
    </div>

    <div id="footercofo6"></div>
    <script src="bootstrap-sncf.metier.v4.3.1-r5/bootstrap-sncf.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js" ></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js" ></script>
    <script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js" ></script>
    <script src="https://cdn.datatables.net/searchpanes/1.2.1/js/dataTables.searchPanes.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>
    <script src="script.js"></script>
    <script>
      $(function(){
        $("#includedContentAC8").load("navcofo.html");
        $("#footercofo6").load("footer.html"); 

      });
      
      
      $(document).ready(function() {
      var table = $('#sessionscofo').DataTable({
        dom: 'BPfrtip',
        "pagingType": "full_numbers",
        columnDefs:[
            {
                searchPanes:{
                    show: true, // It can be true/false
                },
                targets: [0,7], // Index of columns (starting at 0) that you want show/hide                
            },
            {
      orderable: false,
      targets: "no-sort"
    }
        ],
        lengthMenu: [
          [10, 25, 50, 100],
          [ '10 ', '25 ', '50 ', '100 ']
        ],
        buttons: [
          //'searchPanes',
            {
              extend : 'pageLength',
              className : 'btn btn-success mt-1',
              
            },
            {
              text: 'Filtres avancés',
              className: 'btn btn-primary',
              action: function (e, dt, node, config) {
                  $(".dtsp-panesContainer").toggle()
              },
              init: function( api, node, config) {
                  $(node).removeClass('dt-button')
              }
            },
            {
              extend : 'copyHtml5',
              text : 'Copier',
              copyTitle: 'Données copiées',
              className : 'btn btn-warning',
              exportOptions: {
                  columns: [ 0,1,2,3,4,5,6,7]
                },
                init: function( api, node, config) {
                  $(node).removeClass('dt-button buttons-copy buttons-html5')
              }
            },
            {
              extend : 'excelHtml5',
              className : 'btn btn-success',
              title : 'Export liste des sessions du groupe OPSEG-20-6 au '+titleFile(),
              filename : function() {
                var dateStr = dateFile()
                return "Export_Suivi_Sessions_"+dateStr
              },
              exportOptions: {
                columns: [ 0,1,2,3,4,5,6,7]
                },
                init: function( api, node, config) {
                  $(node).removeClass('dt-button buttons-excel buttons-html5')
              },
              customize: function (xlsx) {
                var sheet = xlsx.xl.worksheets['sheet1.xml'];
                $('row c[r^="H"]', sheet).each( function () {
                  if ( $('is t', this).text() == 'Passée' ) {
                        $(this).attr( 's', '15' );
                  }
                  else if($('is t', this).text() == 'À venir'){
                    $(this).attr( 's', '5' );
                  }
                });
              }
            },
            {
              extend : 'csvHtml5',
              className : 'btn btn-success',
              filename : function() {
                var dateStr = dateFile()
                return "Export_Suivi_Sessions_"+dateStr
              },
              exportOptions: {
                columns: [ 0,1,2,3,4,5,6,7]
                },
                init: function( api, node, config) {
                  $(node).removeClass('dt-button buttons-csv buttons-html5')
                }

            },
            {
                extend: 'pdfHtml5',
                orientation: 'landscape',
                pageSize : 'LEGAL',
                exportOptions: {
                  columns: [ 0,1,2,3,4,5,6,7]
                },
                title : 'Export liste des sessions du groupe OPSEG-20-6 au '+titleFile(),
                filename : function() {
                  var dateStr = dateFile()
                  return "Export_Suivi_Sessions_"+dateStr
                },
                customize: function (doc) {
                  doc.content[1].table.widths = 
                      Array(doc.content[1].table.body[0].length + 1).join('*').split('');
                  doc.styles.tableBodyEven.alignment = 'center';
                  doc.styles.tableBodyOdd.alignment = 'center';

                  statut = doc.content[1].table.body
                 
                  for (var i = 1; i < statut.length; i++) {
                    statut[i][7].text = statut[i][7].text.replace("<div class=\"cell-inner\">","")
                    statut[i][7].text = statut[i][7].text.replace("</div>","").trim()
                    if (statut[i][7].text ==="Passée" ) {
                      doc.content[1].table.body[i][7].fillColor = '#82be00';
                    }
                    if (statut[i][7].text==="À venir") {
                      doc.content[1].table.body[i][7].fillColor = '#ffb612';
                    }
                  }
                },
                className : 'btn btn-primary',
                init: function( api, node, config) {
                  $(node).removeClass('dt-button buttons-pdf buttons-html5')
                }
            }
        ],
        "language": {
            "url": "//cdn.datatables.net/plug-ins/1.10.22/i18n/French.json",
            searchPanes: {
                collapse: "Afficher les filtres",
                title : {
                  _: '%d - Filtres sélectionnés',
                  0 : 'Aucun filtres sélectionnés'
                },
                clearMessage : 'Réinitialisé'
            },
            buttons : {
              pageLength: {
                _: "%d éléments par page",
                '-1': "Tout afficher"
              },
              copy: 'Copier',
            copySuccess: {
                1: "Copie d'une ligne",
                _: "Copie de %d lignes"
            },
            copyTitle: 'Données copiées',
            copyKeys: 'Press <i>ctrl</i> or <i>\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>To cancel, click this message or press escape.'

            ,
       
            },
        }
      });
      $('#sessionscofo thead th').addClass('text-white');
      })

      function seeStagiaires(){
          var array = window.location.href.split("/");
          array[array.length-1]="listestagiaires.html";
          location.href = array.join("/");
      }
    </script>
</body>
</html>